---
paths:
  - "**/*_test.go"
  - "testdata/**"
---

# テストルール

## Vault フィクスチャの使い方

- テストデータは `testdata/vault_*` に配置する
- テスト内では `testutil.CopyDir` で `t.TempDir()` にコピーしてから操作する
- 共有フィクスチャを直接変更してはならない
- テスト内でファイルを追加・変更する場合はコピー先に対して行う

## テストの書き方

- 1テストにつき1つの振る舞いを検証する
- DB の内容を検証するには `openDBAt` でテスト用ヘルパーを書く（`countNotes` の例を参照）
- エラー系テストでは、DB やテンポラリファイルが残っていないことも確認する
